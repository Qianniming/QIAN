"use strict";(()=>{var e={};e.id=986,e.ids=[986],e.modules={8013:e=>{e.exports=require("mongodb")},399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},1282:e=>{e.exports=require("child_process")},4770:e=>{e.exports=require("crypto")},665:e=>{e.exports=require("dns")},7702:e=>{e.exports=require("events")},2048:e=>{e.exports=require("fs")},2615:e=>{e.exports=require("http")},8791:e=>{e.exports=require("https")},8216:e=>{e.exports=require("net")},9801:e=>{e.exports=require("os")},5315:e=>{e.exports=require("path")},6162:e=>{e.exports=require("stream")},2452:e=>{e.exports=require("tls")},7360:e=>{e.exports=require("url")},1764:e=>{e.exports=require("util")},1568:e=>{e.exports=require("zlib")},522:(e,r,t)=>{t.r(r),t.d(r,{originalPathname:()=>E,patchFetch:()=>I,requestAsyncStorage:()=>q,routeModule:()=>h,serverHooks:()=>R,staticGenerationAsyncStorage:()=>y});var s={};t.r(s),t.d(s,{GET:()=>g,POST:()=>m});var n=t(9303),o=t(8716),a=t(3131),i=t(7070),u=t(4184),p=t(5637),c=t(2456),d=t(5355),l=t(5245);async function m(e){try{(0,c.dk)(c.Wq)(e);let r=await e.json(),t=(0,p.E8)(r);if(!t.isValid)throw new d.p8("Validation failed",t.errors);let s=(0,p.eI)(r),n=await (0,u.N8)(),o={name:s.name||"",email:s.email||"",phone:s.phone,country:s.country||"",company:s.company,productInterest:s.productInterest,productId:s.productId,productName:s.productName,quantity:s.quantity,message:s.message||"",status:"new",priority:"medium",source:"website",ipAddress:e.ip||e.headers.get("x-forwarded-for")||"unknown",userAgent:e.headers.get("user-agent")||"unknown",notes:[],createdAt:new Date,updatedAt:new Date},a=await n.collection(u.Ul.INQUIRIES).insertOne(o);try{let e=process.env.EMAIL_PASSWORD||process.env.EMAIL_PASS,r=process.env.SMTP_HOST||"smtp.gmail.com",t=parseInt(process.env.SMTP_PORT||"587"),s=process.env.SMTP_USER||process.env.EMAIL_USER,n=process.env.SMTP_FROM||process.env.EMAIL_USER,u=process.env.SMTP_TO||process.env.ADMIN_EMAIL||process.env.EMAIL_USER;if(!s||!e)return console.warn("Email configuration missing, skipping email notifications"),i.NextResponse.json({success:!0,inquiryId:a.insertedId,message:"Inquiry submitted successfully (email notifications disabled)"});let p=l.createTransport({host:r,port:t,secure:!1,auth:{user:s,pass:e}}),c=`
        <h2>New Product Inquiry</h2>
        <p><strong>Product:</strong> ${o.productName}</p>
        <p><strong>Customer:</strong> ${o.name}</p>
        <p><strong>Company:</strong> ${o.company||"N/A"}</p>
        <p><strong>Email:</strong> ${o.email}</p>
        <p><strong>Phone:</strong> ${o.phone||"N/A"}</p>
        <p><strong>Country:</strong> ${o.country||"N/A"}</p>
        <p><strong>Quantity:</strong> ${o.quantity||"N/A"}</p>
        <p><strong>Message:</strong></p>
        <p>${o.message}</p>
        <hr>
        <p><small>Inquiry ID: ${a.insertedId}</small></p>
      `;await p.sendMail({from:n,to:u,subject:`New Product Inquiry - ${o.productName}`,html:c});let d=`
        <h2>Thank you for your inquiry!</h2>
        <p>Dear ${o.name},</p>
        <p>We have received your inquiry about <strong>${o.productName}</strong> and will get back to you within 24 hours.</p>
        <p><strong>Your inquiry details:</strong></p>
        <ul>
          <li>Product: ${o.productName}</li>
          <li>Quantity: ${o.quantity||"Not specified"}</li>
          <li>Message: ${o.message}</li>
        </ul>
        <p>Best regards,<br>WELL-LI Cases Team</p>
        <hr>
        <p><small>Reference ID: ${a.insertedId}</small></p>
      `;await p.sendMail({from:n,to:o.email,subject:`Thank you for your inquiry - ${o.productName}`,html:d})}catch(e){console.error("Failed to send email:",e)}return i.NextResponse.json({success:!0,inquiryId:a.insertedId,message:"Inquiry submitted successfully"},{headers:c.S5})}catch(t){let r=(0,d.zG)(t);return(0,d.H)(r,{context:"product-inquiry",request:e.url}),i.NextResponse.json({error:r.message,code:r.code||"UNKNOWN_ERROR"},{status:r.statusCode||500,headers:c.S5})}}async function g(e){try{let{searchParams:r}=new URL(e.url),t=parseInt(r.get("page")||"1"),s=parseInt(r.get("limit")||"20"),n=r.get("status"),o=(t-1)*s,a=(await (0,u.N8)()).collection(u.Ul.INQUIRIES),p={};n&&(p.status=n);let c=await a.find(p).sort({createdAt:-1}).skip(o).limit(s).toArray(),d=await a.countDocuments(p);return i.NextResponse.json({inquiries:c,pagination:{page:t,limit:s,total:d,pages:Math.ceil(d/s)}})}catch(e){return console.error("Failed to get inquiries:",e),i.NextResponse.json({error:"Failed to get inquiries"},{status:500})}}let h=new n.AppRouteRouteModule({definition:{kind:o.x.APP_ROUTE,page:"/api/inquiries/route",pathname:"/api/inquiries",filename:"route",bundlePath:"app/api/inquiries/route"},resolvedPagePath:"E:\\nanuk\\src\\app\\api\\inquiries\\route.ts",nextConfigOutput:"",userland:s}),{requestAsyncStorage:q,staticGenerationAsyncStorage:y,serverHooks:R}=h,E="/api/inquiries/route";function I(){return(0,a.patchFetch)({serverHooks:R,staticGenerationAsyncStorage:y})}},5355:(e,r,t)=>{t.d(r,{Eg:()=>o,H:()=>u,p8:()=>n,zG:()=>p});class s extends Error{constructor(e,r=500,t){super(e),this.statusCode=r,this.code=t,this.isOperational=!0,Error.captureStackTrace(this,this.constructor)}}class n extends s{constructor(e,r){super(e,400,"VALIDATION_ERROR"),this.name="ValidationError"}}class o extends s{constructor(e="Database operation failed"){super(e,500,"DATABASE_ERROR"),this.name="DatabaseError"}}class a extends s{constructor(e="Network request failed"){super(e,503,"NETWORK_ERROR"),this.name="NetworkError"}}class i extends s{constructor(e="Authentication failed"){super(e,401,"AUTH_ERROR"),this.name="AuthenticationError"}}function u(e,r){return{message:e.message,stack:e.stack,timestamp:new Date,...e instanceof s&&{code:e.code,statusCode:e.statusCode},...!1,...r}}function p(e){if("TypeError"===e.name&&e.message.includes("fetch"))return new a("Failed to connect to server");if(e.response){let r=e.response.status,t=e.response.data?.message||e.message;switch(r){case 400:return new n(t);case 401:return new i(t);case 404:return new s("Resource not found",404,"NOT_FOUND");case 429:return new s("Too many requests",429,"RATE_LIMIT");case 500:return new s("Internal server error",500,"SERVER_ERROR");default:return new s(t,r)}}return"MongoError"===e.name||"MongoServerError"===e.name?new o(`Database error: ${e.message}`):"ValidationError"===e.name?new n(e.message):new s(e.message||"An unexpected error occurred")}}};var r=require("../../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),s=r.X(0,[948,972,245,253],()=>t(522));module.exports=s})();