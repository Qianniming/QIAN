"use strict";exports.id=253,exports.ids=[253],exports.modules={5637:(e,t,n)=>{function s(e){let t=[];if(e.name&&"string"==typeof e.name){let n=e.name.trim();(n.length<o.name.minLength||n.length>o.name.maxLength)&&t.push(`Name must be between ${o.name.minLength} and ${o.name.maxLength} characters`),/[<>"'&\{\}]/.test(n)&&t.push("Name contains invalid characters")}else t.push("Name is required");if(e.email&&"string"==typeof e.email){let n=e.email.trim().toLowerCase();o.email.pattern.test(n)||t.push("Invalid email format"),n.length>254&&t.push("Email address is too long")}else t.push("Email is required");if(e.country&&"string"==typeof e.country){let n=e.country.trim();n.length>o.country.maxLength&&t.push(`Country must be less than ${o.country.maxLength} characters`),/[<>"'&\{\}]/.test(n)&&t.push("Country contains invalid characters")}else t.push("Country is required");if(e.message&&"string"==typeof e.message){let n=e.message.trim();(n.length<o.message.minLength||n.length>o.message.maxLength)&&t.push(`Message must be between ${o.message.minLength} and ${o.message.maxLength} characters`)}else t.push("Message is required");if(e.phone&&"string"==typeof e.phone){let n=e.phone.trim();n.length>o.phone.maxLength&&t.push(`Phone must be less than ${o.phone.maxLength} characters`),/^[+\d\s\-\(\)]+$/.test(n)||t.push("Phone number contains invalid characters")}if(e.company&&"string"==typeof e.company){let n=e.company.trim();n.length>o.company.maxLength&&t.push(`Company must be less than ${o.company.maxLength} characters`),/[<>"'&\{\}]/.test(n)&&t.push("Company name contains invalid characters")}let n=[/<script[^>]*>.*?<\/script>/gi,/javascript:/gi,/on\w+\s*=/gi,/data:(?:text\/html|application\/javascript)/gi];for(let s of[e.name,e.message,e.company,e.productInterest])if("string"==typeof s){for(let e of n)if(e.test(s)){t.push("Invalid content detected");break}}return{isValid:0===t.length,errors:t}}function i(e){let t=[];if(e.name&&"string"==typeof e.name){let n=e.name.trim();(n.length<c.name.minLength||n.length>c.name.maxLength)&&t.push(`Name must be between ${c.name.minLength} and ${c.name.maxLength} characters`),/[<>"'&\{\}]/.test(n)&&t.push("Name contains invalid characters")}else t.push("Name is required");if(e.category&&"string"==typeof e.category){let n=e.category.trim();n.length>c.category.maxLength&&t.push(`Category must be less than ${c.category.maxLength} characters`),/[<>"'&\{\}]/.test(n)&&t.push("Category contains invalid characters")}else t.push("Category is required");if(e.description&&"string"==typeof e.description){let n=e.description.trim();(n.length<c.description.minLength||n.length>c.description.maxLength)&&t.push(`Description must be between ${c.description.minLength} and ${c.description.maxLength} characters`)}else t.push("Description is required");if(Array.isArray(e.images)){if(e.images.length<c.images.minItems)t.push(`At least ${c.images.minItems} image is required`);else for(let n of e.images)if("string"!=typeof n||!n.trim()){t.push("All images must be valid URLs");break}}else t.push("Images must be an array");if(e.specifications&&"object"==typeof e.specifications||t.push("Specifications are required"),Array.isArray(e.features)){if(e.features.length<c.features.minItems)t.push(`At least ${c.features.minItems} feature is required`);else for(let n of e.features)if("string"!=typeof n||!n.trim()){t.push("All features must be valid strings");break}}else t.push("Features must be an array");return e.slug&&"string"==typeof e.slug&&!/^[a-z0-9-]+$/.test(e.slug)&&t.push("Slug must contain only lowercase letters, numbers, and hyphens"),{isValid:0===t.length,errors:t}}function a(e){return"string"!=typeof e?"":e.trim().replace(/[<>"'&]/g,e=>({"<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","&":"&amp;"})[e]||e).replace(/javascript:/gi,"").replace(/on\w+\s*=/gi,"").replace(/<script[^>]*>.*?<\/script>/gi,"").replace(/data:(?:text\/html|application\/javascript)/gi,"").substring(0,2e3)}function r(e){let t={name:e.name?a(e.name):"",email:e.email?a(e.email.toLowerCase().trim()):"",phone:e.phone?a(e.phone):void 0,country:e.country?a(e.country):"",company:e.company?a(e.company):void 0,productInterest:e.productInterest?a(e.productInterest):void 0,productId:e.productId?a(e.productId):void 0,productName:e.productName?a(e.productName):void 0,quantity:e.quantity?a(e.quantity):void 0,message:e.message?a(e.message):""};return Object.keys(t).forEach(e=>{(void 0===t[e]||""===t[e])&&"name"!==e&&"email"!==e&&"country"!==e&&"message"!==e&&delete t[e]}),t}n.d(t,{E8:()=>s,Us:()=>m,eI:()=>r,q$:()=>i,vJ:()=>a});let o={name:{required:!0,minLength:2,maxLength:100},email:{required:!0,pattern:/^[^\s@]+@[^\s@]+\.[^\s@]+$/},phone:{required:!1,maxLength:20},country:{required:!0,maxLength:50},company:{required:!1,maxLength:100},message:{required:!0,minLength:10,maxLength:2e3}},c={name:{required:!0,minLength:3,maxLength:200},category:{required:!0,maxLength:50},description:{required:!0,minLength:10,maxLength:500},images:{required:!0,minItems:1},features:{required:!0,minItems:1}},m={status:"new",priority:"medium",source:"website",notes:[],createdAt:new Date,updatedAt:new Date}},4184:(e,t,n)=>{let s;n.d(t,{M7:()=>m,N8:()=>o,Ul:()=>c,xN:()=>l});var i=n(8013);let a={maxPoolSize:10,serverSelectionTimeoutMS:5e3,socketTimeoutMS:45e3,family:4,tls:!0,tlsAllowInvalidCertificates:!1,tlsAllowInvalidHostnames:!1,retryWrites:!0,retryReads:!0,authSource:"admin"};function r(){return s||(s=new i.MongoClient("mongodb+srv://766282480qnm_db_user:13195622840Qbb@weili-website.x7cdvcd.mongodb.net/wellicases?retryWrites=true&w=majority&appName=WEILI-website&ssl=true&authSource=admin",a).connect())}async function o(){try{return(await r()).db("wellicases")}catch(e){throw console.error("Failed to connect to database:",e),Error("Database connection failed")}}let c={INQUIRIES:"inquiries",PRODUCTS:"products",USERS:"users",SETTINGS:"settings"};async function m(e=3){for(let t=0;t<e;t++)try{let e=await r();return await e.db("admin").command({ping:1}),console.log("✅ MongoDB connection successful"),!0}catch(n){if(console.error(`❌ MongoDB connection attempt ${t+1} failed:`,n.message),t===e-1)return console.error("❌ All MongoDB connection attempts failed"),console.warn("⚠️ This might be due to SSL/TLS compatibility issues on Windows"),console.warn("⚠️ The application will continue without database connection"),!1;await new Promise(e=>setTimeout(e,1e3*(t+1)))}return!1}async function l(){try{let e=await o();await Promise.all([e.collection(c.INQUIRIES).createIndexes([{key:{email:1}},{key:{createdAt:-1}},{key:{country:1}},{key:{productInterest:1}},{key:{status:1}}]).catch(e=>console.warn("Failed to create inquiries indexes:",e)),e.collection(c.PRODUCTS).createIndexes([{key:{name:"text",description:"text"}},{key:{category:1}},{key:{featured:1}},{key:{active:1}},{key:{slug:1},unique:!0}]).catch(e=>console.warn("Failed to create products indexes:",e))]),console.log("✅ Database indexes created successfully")}catch(e){console.error("❌ Failed to initialize database:",e),console.warn("Database initialization failed, continuing without indexes")}}},2456:(e,t,n)=>{n.d(t,{Lm:()=>i,S5:()=>o,Wq:()=>a,dk:()=>r});class s{constructor(e){this.store={},this.config=e,setInterval(()=>{this.cleanup()},3e5)}cleanup(){let e=Date.now();Object.keys(this.store).forEach(t=>{this.store[t].resetTime<=e&&delete this.store[t]})}getKey(e){return this.config.keyGenerator?this.config.keyGenerator(e):e.ip||e.headers.get("x-forwarded-for")||e.headers.get("x-real-ip")||"unknown"}check(e){let t=this.getKey(e),n=Date.now(),s=n+this.config.windowMs;(!this.store[t]||this.store[t].resetTime<=n)&&(this.store[t]={count:0,resetTime:s});let i=this.store[t],a=i.count<this.config.maxRequests;return a&&i.count++,{allowed:a,limit:this.config.maxRequests,remaining:Math.max(0,this.config.maxRequests-i.count),resetTime:i.resetTime}}}let i=new s({windowMs:9e5,maxRequests:5}),a=new s({windowMs:9e5,maxRequests:10});function r(e){return t=>{let n=e.check(t);if(!n.allowed){let e=Math.ceil((n.resetTime-Date.now())/1e3);throw Error(`Rate limit exceeded. Try again in ${e} seconds.`)}return n}}new s({windowMs:6e4,maxRequests:60});let o={"X-Frame-Options":"DENY","X-Content-Type-Options":"nosniff","Referrer-Policy":"origin-when-cross-origin","X-DNS-Prefetch-Control":"on","Strict-Transport-Security":"max-age=31536000; includeSubDomains","Permissions-Policy":"geolocation=(), microphone=(), camera=()","Content-Security-Policy":"default-src 'self'; script-src 'self' 'unsafe-inline' 'unsafe-eval'; style-src 'self' 'unsafe-inline'; img-src 'self' data: https:; font-src 'self'; connect-src 'self'; frame-ancestors 'none';"}}};